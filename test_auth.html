<!DOCTYPE html>
<html>
<head>
    <title>Auth Test</title>
</head>
<body>
    <h1>Authentication Test</h1>
    <div id="output"></div>
    
    <script>
        const output = document.getElementById('output');
        
        // Check localStorage for auth data
        const token = localStorage.getItem('authToken');
        const user = localStorage.getItem('user');
        
        let html = '<h2>LocalStorage Contents:</h2>';
        html += '<p><strong>Token:</strong> ' + (token ? token.substring(0, 50) + '...' : 'null') + '</p>';
        html += '<p><strong>User:</strong> ' + (user || 'null') + '</p>';
        
        if (token && user) {
            html += '<h2>Authentication Status:</h2>';
            html += '<p style="color: green;">✅ User appears to be authenticated</p>';
            
            // Test API call
            html += '<h2>API Test:</h2>';
            html += '<button onclick="testAPI()">Test Accounts API</button>';
            html += '<div id="api-result"></div>';
        } else {
            html += '<p style="color: red;">❌ User not authenticated</p>';
        }
        
        output.innerHTML = html;
        
        async function testAPI() {
            try {
                const response = await fetch('http://localhost:5001/api/emails/accounts', {
                    headers: {
                        'Authorization': 'Bearer ' + token,
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                document.getElementById('api-result').innerHTML = 
                    '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            } catch (error) {
                document.getElementById('api-result').innerHTML = 
                    '<p style="color: red;">Error: ' + error.message + '</p>';
            }
        }
        
        window.testAPI = testAPI;
    </script>
</body>
</html>
